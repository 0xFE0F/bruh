<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Base URL + Values Manager</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; }
  .entry { border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; border-radius: 5px; background: #fff; }
  .entry-header { display: flex; justify-content: space-between; align-items: center; }
  .entry-title { font-weight: bold; font-size: 1.1em; }
  .url-base { font-family: monospace; margin-top: 4px; margin-bottom: 10px; }
  .values-list { margin-left: 0; padding-left: 0; list-style: none; }
  .value-item { display: flex; align-items: center; margin-bottom: 6px; }
  .value-link { flex-grow: 1; text-decoration: none; color: blue; word-break: break-all; font-family: monospace; }
  button { margin-left: 6px; }
  label { display: block; margin: 8px 0 4px; }
  input[type="text"] { width: 100%; padding: 6px; box-sizing: border-box; }
  .controls { margin-top: 10px; }
</style>
</head>
<body>

<h1>Base URL + Values Manager</h1>

<section>
  <h2>Add New Entry</h2>
  <label for="titleInput">Title:</label>
  <input id="titleInput" type="text" placeholder="Entry title" />
  
  <label for="baseInput">Base URL (include &lt;&lt;V&gt;&gt; placeholder):</label>
  <input id="baseInput" type="text" placeholder="e.g. https://example.com/search?q=<<V>>" />
  
  <label for="valuesInput">Values (comma-separated):</label>
  <input id="valuesInput" type="text" placeholder="e.g. apple, banana, cherry" />
  
  <button onclick="addEntry()">Add Entry</button>
  <button onclick="exportEntries()">Export Entries</button>
  <input type="file" id="importFile" accept=".json" onchange="importEntries(event)" />
</section>

<hr/>

<section>
  <h2>Saved Entries</h2>
  <div id="entriesContainer"></div>
</section>

<script>
  let entries = JSON.parse(localStorage.getItem('baseUrlEntries') || '{}');

  function saveEntries() {
    localStorage.setItem('baseUrlEntries', JSON.stringify(entries));
  }

  function renderEntries() {
    const container = document.getElementById('entriesContainer');
    container.innerHTML = '';

    for (const [title, entry] of Object.entries(entries)) {
      const div = document.createElement('div');
      div.className = 'entry';

      // Header with title and buttons
      const header = document.createElement('div');
      header.className = 'entry-header';

      const titleEl = document.createElement('div');
      titleEl.className = 'entry-title';
      titleEl.textContent = title;
      header.appendChild(titleEl);

      // Buttons container
      const btnContainer = document.createElement('div');

      // Open All button
      const openAllBtn = document.createElement('button');
      openAllBtn.textContent = 'Open All';
      openAllBtn.onclick = () => {
        entry.values.forEach(v => {
          const url = entry.base.replace('<<V>>', v);
          window.open(url, '_blank', 'noopener,noreferrer');
        });
      };
      btnContainer.appendChild(openAllBtn);

      // Delete Entry button with confirmation
      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => {
        if (confirm(`Are you sure you want to delete entry "${title}"?`)) {
          delete entries[title];
          saveEntries();
          renderEntries();
        }
      };
      btnContainer.appendChild(deleteBtn);

      header.appendChild(btnContainer);
      div.appendChild(header);

      // Show base URL
      const baseUrlEl = document.createElement('div');
      baseUrlEl.className = 'url-base';
      baseUrlEl.textContent = 'Base URL: ' + entry.base;
      div.appendChild(baseUrlEl);

      // Values list with remove buttons
      const valuesList = document.createElement('ul');
      valuesList.className = 'values-list';

      entry.values.forEach((val, i) => {
        const li = document.createElement('li');
        li.className = 'value-item';

        const a = document.createElement('a');
        a.href = entry.base.replace('<<V>>', val);
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.textContent = val;
        a.className = 'value-link';
        li.appendChild(a);

        const removeValBtn = document.createElement('button');
        removeValBtn.textContent = 'X';
        removeValBtn.title = 'Remove this value';
        removeValBtn.onclick = () => {
          entry.values.splice(i, 1);
          saveEntries();
          renderEntries();
        };
        li.appendChild(removeValBtn);

        valuesList.appendChild(li);
      });
      div.appendChild(valuesList);

      // Add Value button and input
      const addValueContainer = document.createElement('div');
      addValueContainer.className = 'controls';

      const addValueInput = document.createElement('input');
      addValueInput.type = 'text';
      addValueInput.placeholder = 'Add new value...';
      addValueInput.style.width = '70%';
      addValueInput.onkeydown = e => {
        if (e.key === 'Enter') {
          addValueBtn.click();
        }
      };
      addValueContainer.appendChild(addValueInput);

      const addValueBtn = document.createElement('button');
      addValueBtn.textContent = 'Add Value';
      addValueBtn.onclick = () => {
        const val = addValueInput.value.trim();
        if (!val) return alert('Please enter a value.');
        entry.values.push(val);
        saveEntries();
        renderEntries();
      };
      addValueContainer.appendChild(addValueBtn);

      div.appendChild(addValueContainer);

      container.appendChild(div);
    }
  }

  function addEntry() {
    const title = document.getElementById('titleInput').value.trim();
    const base = document.getElementById('baseInput').value.trim();
    let valuesRaw = document.getElementById('valuesInput').value.trim();

    if (!title) return alert('Please enter a title.');
	if (entries[title]) return alert('Entry under that title already exists.')
	
    if (!base || !base.includes('<<V>>')) return alert('Base URL must include the <<V>> placeholder.');
    if (!valuesRaw){valuesRaw = ''};

    const values = valuesRaw.split(',').map(v => v.trim()).filter(v => v);

    entries[title] = { base, values };
    saveEntries();
    renderEntries();

    // Clear inputs
    document.getElementById('titleInput').value = '';
    document.getElementById('baseInput').value = '';
    document.getElementById('valuesInput').value = '';
  }

  function exportEntries() {
    const blob = new Blob([JSON.stringify(entries, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    window.open(url, '_blank');
    setTimeout(() => URL.revokeObjectURL(url), 60000);
  }

  function importEntries(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = e => {
      try {
        const imported = JSON.parse(e.target.result);
        if (typeof imported === 'object' && imported !== null) {
          entries = imported;
          saveEntries();
          renderEntries();
        } else {
          alert('Invalid file format.');
        }
      } catch {
        alert('Error parsing JSON file.');
      }
      event.target.value = ''; // reset input so same file can be re-imported
    };
    reader.readAsText(file);
  }

  renderEntries();
</script>

</body>
</html>
